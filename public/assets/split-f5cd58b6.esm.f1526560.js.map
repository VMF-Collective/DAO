{"version":3,"file":"split-f5cd58b6.esm.f1526560.js","sources":["../../node_modules/@thirdweb-dev/sdk/dist/split-f5cd58b6.esm.js"],"sourcesContent":["import { _ as _defineProperty } from './QueryParams-bc2daded.esm.js';\nimport { cz as ContractWrapper, ab as ContractMetadata, c_ as SplitsContractSchema, ac as ContractRoles, aa as ContractEncoder, aL as GasCostEstimator, aM as ContractEvents, aN as ContractInterceptor, aZ as fetchCurrencyValue } from './thirdweb-checkout-28b27df7.esm.js';\nimport ERC20Abi from '@thirdweb-dev/contracts-js/dist/abis/IERC20.json';\nimport { BigNumber, Contract } from 'ethers';\nimport 'bn.js';\nimport 'zod';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC165.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC721.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC1155.json';\nimport 'tiny-invariant';\nimport '@thirdweb-dev/contracts-js/dist/abis/IBurnableERC20.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDrop.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropERC20_V2.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase_V1.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IMintableERC20.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IMulticall.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC20.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IBurnableERC721.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IClaimableERC721.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDelayedReveal.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropERC721_V3.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC721Enumerable.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC721Supply.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ILazyMint.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IMintableERC721.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721_V1.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/LazyMintWithTier.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IBurnableERC1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IClaimableERC1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDrop1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropERC1155_V2.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155_V1.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC1155Enumerable.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IMintableERC1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC1155.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ERC2771Context.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IAppURI.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IContractMetadata.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDirectListings.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IEnglishAuctions.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IOffers.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IPackVRFDirect.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IPermissions.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IPermissionsEnumerable.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IPlatformFee.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IPrimarySale.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IRouter.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IRoyalty.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/Ownable.json';\nimport 'cross-fetch';\nimport 'eventemitter3';\nimport '@thirdweb-dev/contracts-js/dist/abis/Forwarder.json';\nimport '@thirdweb-dev/storage';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC20Metadata.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/Router.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IThirdwebContract.json';\nimport 'merkletreejs';\nimport 'fast-deep-equal';\nimport 'uuid';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC721Metadata.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IERC1155Metadata.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/IDelayedRevealDeprecated.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/TWFactory.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/TWRegistry.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/ContractPublisher.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryLogic.json';\nimport '@thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryRouter.json';\nimport 'bs58';\n\n/**\n * Create custom royalty splits to distribute funds.\n *\n * @example\n *\n * ```javascript\n * import { ThirdwebSDK } from \"@thirdweb-dev/sdk\";\n *\n * const sdk = new ThirdwebSDK(\"{{chainName}}\");\n * const contract = await sdk.getContract(\"{{contract_address}}\", \"split\");\n * ```\n *\n * @public\n */\nclass Split {\n  /**\n   * @internal\n   */\n\n  get chainId() {\n    return this._chainId;\n  }\n  constructor(network, address, storage) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    let abi = arguments.length > 4 ? arguments[4] : undefined;\n    let chainId = arguments.length > 5 ? arguments[5] : undefined;\n    let contractWrapper = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new ContractWrapper(network, address, abi, options);\n    _defineProperty(this, \"contractWrapper\", void 0);\n    _defineProperty(this, \"storage\", void 0);\n    _defineProperty(this, \"abi\", void 0);\n    _defineProperty(this, \"metadata\", void 0);\n    _defineProperty(this, \"encoder\", void 0);\n    _defineProperty(this, \"estimator\", void 0);\n    _defineProperty(this, \"events\", void 0);\n    _defineProperty(this, \"roles\", void 0);\n    _defineProperty(this, \"interceptor\", void 0);\n    _defineProperty(this, \"_chainId\", void 0);\n    this._chainId = chainId;\n    this.abi = abi;\n    this.contractWrapper = contractWrapper;\n    this.storage = storage;\n    this.metadata = new ContractMetadata(this.contractWrapper, SplitsContractSchema, this.storage);\n    this.roles = new ContractRoles(this.contractWrapper, Split.contractRoles);\n    this.encoder = new ContractEncoder(this.contractWrapper);\n    this.estimator = new GasCostEstimator(this.contractWrapper);\n    this.events = new ContractEvents(this.contractWrapper);\n    this.interceptor = new ContractInterceptor(this.contractWrapper);\n  }\n  onNetworkUpdated(network) {\n    this.contractWrapper.updateSignerOrProvider(network);\n  }\n  getAddress() {\n    return this.contractWrapper.readContract.address;\n  }\n\n  /** ******************************\n   * READ FUNCTIONS\n   *******************************/\n\n  /**\n   * Get Recipients of this splits contract\n   *\n   * @remarks Get the data about the shares of every split recipient on the contract\n   *\n   * @example\n   * ```javascript\n   * const recipients = await contract.getAllRecipients();\n   * console.log(recipients);\n   * ```\n   */\n  async getAllRecipients() {\n    const recipients = [];\n    let index = BigNumber.from(0);\n    const totalRecipients = await this.contractWrapper.readContract.payeeCount();\n    while (index.lt(totalRecipients)) {\n      try {\n        const recipientAddress = await this.contractWrapper.readContract.payee(index);\n        recipients.push(await this.getRecipientSplitPercentage(recipientAddress));\n        index = index.add(1);\n      } catch (err) {\n        // The only way we know how to detect that we've found all recipients\n        // is if we get an error when trying to get the next recipient.\n        if (\"method\" in err && err[\"method\"].toLowerCase().includes(\"payee(uint256)\")) {\n          break;\n        } else {\n          throw err;\n        }\n      }\n    }\n    return recipients;\n  }\n\n  /**\n   * Returns all the recipients and their balances in the native currency.\n   *\n   * @returns A map of recipient addresses to their balances in the native currency.\n   */\n  async balanceOfAllRecipients() {\n    const recipients = await this.getAllRecipients();\n    const balances = {};\n    for (const recipient of recipients) {\n      balances[recipient.address] = await this.balanceOf(recipient.address);\n    }\n    return balances;\n  }\n\n  /**\n   * Returns all the recipients and their balances in a non-native currency.\n   *\n   * @param tokenAddress - The address of the currency to check the balances in.\n   * @returns A map of recipient addresses to their balances in the specified currency.\n   */\n  async balanceOfTokenAllRecipients(tokenAddress) {\n    const recipients = await this.getAllRecipients();\n    const balances = {};\n    for (const recipient of recipients) {\n      balances[recipient.address] = await this.balanceOfToken(recipient.address, tokenAddress);\n    }\n    return balances;\n  }\n\n  /**\n   * Get Funds owed to a particular wallet\n   *\n   * @remarks Get the amount of funds in the native currency held by the contract that is owed to a specific recipient.\n   *\n   * @example\n   * ```javascript\n   * // The address to check the funds of\n   * const address = \"{{wallet_address}}\";\n   * const funds = await contract.balanceOf(address);\n   * console.log(funds);\n   * ```\n   */\n  async balanceOf(address) {\n    const walletBalance = await this.contractWrapper.readContract.provider.getBalance(this.getAddress());\n    const totalReleased = await this.contractWrapper.readContract[\"totalReleased()\"]();\n    const totalReceived = walletBalance.add(totalReleased);\n    return this._pendingPayment(address, totalReceived, await this.contractWrapper.readContract[\"released(address)\"](address));\n  }\n\n  /**\n   * Get non-native Token Funds owed to a particular wallet\n   *\n   * @remarks Get the amount of funds in the non-native tokens held by the contract that is owed to a specific recipient.\n   *\n   * @example\n   * ```javascript\n   * // The address to check the funds of\n   * const address = \"{{wallet_address}}\";\n   * // The address of the currency to check the contracts funds of\n   * const tokenAddress = \"0x...\"\n   * const funds = await contract.balanceOfToken(address, tokenAddress);\n   * console.log(funds);\n   * ```\n   */\n  async balanceOfToken(walletAddress, tokenAddress) {\n    const erc20 = new Contract(tokenAddress, ERC20Abi, this.contractWrapper.getProvider());\n    const walletBalance = await erc20.balanceOf(this.getAddress());\n    const totalReleased = await this.contractWrapper.readContract[\"totalReleased(address)\"](tokenAddress);\n    const totalReceived = walletBalance.add(totalReleased);\n    const value = await this._pendingPayment(walletAddress, totalReceived, await this.contractWrapper.readContract[\"released(address,address)\"](tokenAddress, walletAddress));\n    return await fetchCurrencyValue(this.contractWrapper.getProvider(), tokenAddress, value);\n  }\n\n  /**\n   * Get the % of funds owed to a given address\n   * @param address - the address to check percentage of\n   */\n  async getRecipientSplitPercentage(address) {\n    const [totalShares, walletsShares] = await Promise.all([this.contractWrapper.readContract.totalShares(), this.contractWrapper.readContract.shares(address)]);\n    // We convert to basis points to avoid floating point loss of precision\n    return {\n      address,\n      splitPercentage: walletsShares.mul(BigNumber.from(1e7)).div(totalShares).toNumber() / 1e5\n    };\n  }\n\n  /** ******************************\n   * WRITE FUNCTIONS\n   *******************************/\n\n  /**\n   * Withdraw Funds\n   * @remarks Triggers a transfer to account of the amount of native currency they are owed.\n   *\n   * @example\n   * ```javascript\n   * // the wallet address that wants to withdraw their funds\n   * const walletAddress = \"{{wallet_address}}\"\n   * await contract.withdraw(walletAddress);\n   * ```\n   *\n   * @param walletAddress - The address to distributes the amount to\n   */\n  async withdraw(walletAddress) {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"release(address)\", [walletAddress])\n    };\n  }\n\n  /**\n   * Triggers a transfer to account of the amount of a given currency they are owed.\n   *\n   * @param walletAddress - The address to distributes the amount to\n   * @param tokenAddress - The address of the currency contract to distribute funds\n   */\n  async withdrawToken(walletAddress, tokenAddress) {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"release(address,address)\", [tokenAddress, walletAddress])\n    };\n  }\n\n  /**\n   * Distribute Funds\n   *\n   * @remarks Distribute funds held by the contract in the native currency to all recipients.\n   *\n   * @example\n   * ```javascript\n   * await contract.distribute();\n   * ```\n   */\n  async distribute() {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"distribute()\", [])\n    };\n  }\n\n  /**\n   * Distribute Funds\n   *\n   * @remarks Distribute funds held by the contract in the native currency to all recipients.\n   *\n   * @example\n   * ```javascript\n   * // The address of the currency to distribute funds\n   * const tokenAddress = \"0x...\"\n   * await contract.distributeToken(tokenAddress);\n   * ```\n   *\n   * @param tokenAddress - The address of the currency contract to distribute funds\n   */\n  async distributeToken(tokenAddress) {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"distribute(address)\", [tokenAddress])\n    };\n  }\n\n  /** ******************************\n   * PRIVATE FUNCTIONS\n   *******************************/\n\n  async _pendingPayment(address, totalReceived, alreadyReleased) {\n    const addressReceived = totalReceived.mul(await this.contractWrapper.readContract.shares(address));\n    const totalRoyaltyAvailable = addressReceived.div(await this.contractWrapper.readContract.totalShares());\n    return totalRoyaltyAvailable.sub(alreadyReleased);\n  }\n\n  /**\n   * @internal\n   */\n  async call(functionName) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return this.contractWrapper.call(functionName, ...args);\n  }\n}\n_defineProperty(Split, \"contractRoles\", [\"admin\"]);\n\nexport { Split };\n"],"names":["Split","network","address","storage","options","abi","chainId","contractWrapper","ContractWrapper","_defineProperty","ContractMetadata","SplitsContractSchema","ContractRoles","ContractEncoder","GasCostEstimator","ContractEvents","ContractInterceptor","recipients","index","BigNumber","totalRecipients","recipientAddress","err","balances","recipient","tokenAddress","walletBalance","totalReleased","totalReceived","walletAddress","Contract","ERC20Abi","value","fetchCurrencyValue","totalShares","walletsShares","alreadyReleased","functionName","_len","args","_key"],"mappings":"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"}